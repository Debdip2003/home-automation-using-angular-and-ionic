<!-- HEADER -->
<ion-header>
  <ion-toolbar>
    <ion-title>Smart Home</ion-title>

    <ion-buttons slot="end">
      @if (user) {
      <ion-button fill="clear" (click)="logoutUser()">
        <ion-icon
          slot="icon-only"
          name="log-out-outline"
          size="large"
        ></ion-icon>
      </ion-button>
      } @else {
      <ion-button fill="clear" (click)="navigateToLoginOrSignupOrProfile()">
        <ion-icon
          slot="icon-only"
          name="person-circle-outline"
          size="large"
        ></ion-icon>
      </ion-button>
      }
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<!-- CONTENT -->
<ion-content fullscreen class="ion-padding">
  <!-- WELCOME -->
  <ion-item lines="none">
    <ion-label>
      @if(!user){
      <h1 class="ion-no-margin font-normal">Welcome to Smart Home</h1>
      <p class="ion-text-muted">Please log in to access your dashboard</p>
      }@else {
      <h1 class="ion-no-margin font-normal">Welcome {{user.name}}</h1>
      <p class="ion-text-muted">Your smart home dashboard</p>
      }
    </ion-label>
  </ion-item>

  <!-- WEATHER CARD -->
  <ion-card class="ion-padding">
    <ion-item lines="none">
      <ion-icon
        name="cloud-outline"
        size="large"
        color="secondary"
        slot="start"
      ></ion-icon>

      <ion-label>
        <ion-card-subtitle>Mostly Cloudy</ion-card-subtitle>
        <ion-card-title>
          {{ currentLocation()?.address?.city || 'Your City' }}
        </ion-card-title>
      </ion-label>

      <ion-text slot="end" color="secondary">
        <h1 class="ion-no-margin">{{ currentTemp() | number:'1.0-0' }}Â° C</h1>
      </ion-text>
    </ion-item>
  </ion-card>

  <!-- ROOMS HEADER -->
  <ion-item-divider>
    <ion-label>Your Rooms</ion-label>
  </ion-item-divider>

  <!-- ROOMS GRID -->
  <ion-grid>
    <ion-reorder-group
      [disabled]="false"
      (ionReorderEnd)="handleReorderEnd($any($event))"
    >
      @for (room of roomData(); track $index) {
      <ion-col size="12" sizeMd="6" sizeLg="4">
        <app-room-card
          [roomData]="room"
          (deleteRoom)="handleDeleteRoom(room.id)"
        ></app-room-card>
      </ion-col>
      }
    </ion-reorder-group>
  </ion-grid>

  <!-- ADD ROOM FAB -->
  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button color="danger" (click)="openModal()">
      <ion-icon name="add" size="large"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>
